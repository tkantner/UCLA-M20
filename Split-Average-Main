%Split and Average Problem- A program to subdivide and smooth surfaces
%given the original coordinates in vectors

%Housekeeping
clear all;
clc;
close all;

%Initialize x and y and w
x = [0, .5, 1, .5];
y = [.5, 1, .5, 0];
x0 = x; %To plot original
y0 = y;
w = [1, 2, 1];

%Check for the sum
if sum(w) == 0
    error('Weight sum cannot be 0');
end

%Initialize tracker variables
maxDis = 1;
ItCount = 0;

%Iterate until no longer necessary
while maxDis >= 1e-3 && ItCount < 20  %I set 20 as a limit
    ItCount = ItCount + 1; %Increase Iteration Count
    xs = splitPts(x);
    ys = splitPts(y);
    xa = averagePts(xs, w);
    ya = averagePts(ys, w);
    x = xa;
    y = ya;
    %Check to see if we should continue
    dx = xa - xs;
    dy = ya - ys;
    maxDis = max(sqrt(dx.^2+dy.^2));
end

%Plot the results
plot(x, y,'.', x0, y0 ,'.');
title('Plot of Split and Average Results');
xlabel('x');
ylabel('y');
legend('New Points', 'Original Points');
